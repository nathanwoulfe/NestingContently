angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.Buttons.Controller",["$scope",function(n){function u(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);t.multiple=Object.toBoolean(i.enableMultiple);t.multiple===!1&&n.model.value.length>0&&n.model.value.splice(1);t.hideIcon=i.labelStyle==="text";t.hideName=i.labelStyle==="icon";t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;t.size=i.size;t.defaultIcon=i.defaultIcon;t.iconExtras=(t.hideName===!1?" mr2 ":" mr0 ")+{s:"small",m:"medium",l:"large"}[i.size];t.items=[];i.items.forEach(i=>{var r=Object.assign({},i);r.selected=n.model.value.indexOf(r.value)>-1;t.items.push(r)});t.select=e;n.umbProperty&&(t.propertyActions=[],Object.toBoolean(i.allowClear)===!0&&t.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:f}),t.propertyActions.length>0&&n.umbProperty.setPropertyActions(t.propertyActions))}function f(){n.model.value=[];t.items.forEach(n=>n.selected=!1);r()}function e(i){i.selected=i.selected===!1;n.model.value=[];t.items.forEach(r=>{t.multiple===!1&&(r.selected=r.value===i.value),r.selected&&n.model.value.push(r.value)});r()}function r(){n.propertyForm&&n.propertyForm.$setDirty()}var i=Object.assign({},{allowClear:0,defaultIcon:"icon-science",defaultValue:[],items:[],enableMultiple:0,labelStyle:"both",size:"m"},n.model.config),t=this;u()}]);angular.module("umbraco.filters").filter("formatBytes",function(){return function(n,t){if(n===0||t===undefined)return"0 Bytes";const i=parseInt(t.kilo)||1024,u=parseInt(t.decimals)||0,r=Math.floor(Math.log(n)/Math.log(i));return parseFloat((n/Math.pow(i,r)).toFixed(u))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}});angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.CascadingDropdownList.Controller",["$scope","$q","$http",function(n,t,i){function f(){var h,f,s,o;if(n.model.value=n.model.value||u.defaultValue,r.dropdowns=[],u.apis.length>0){for(r.loading=!0,h=[],f=0;f<n.model.value.length;f++){for(s=u.apis[f],o=0;o<f;o++)s=s.replace("{"+o+"}",n.model.value[o]);h.push(i({method:"GET",url:s}))}t.all(h).then(function(n){n&&n.forEach(function(n,t){r.dropdowns[t]={options:n.data}});r.loading=!1})}r.change=e}function e(t){var f=t+1,e;u.apis.length>f&&(r.loading=!0,e=u.apis[f].replace(/{(\d+)}/g,function(t,i){return typeof n.model.value[i]!="undefined"?n.model.value[i]:t}),i({method:"GET",url:e}).then(function(n){r.dropdowns[f]={options:n.data};r.loading=!1}));o()}function o(){n.propertyForm&&n.propertyForm.$setDirty()}if(!n.model.hasOwnProperty("contentTypeId")){var u=Object.assign({},{apis:[],defaultValue:[""]},n.model.config),r=this;f()}}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.CheckboxList.Controller",["$scope","localizationService",function(n,t){function f(){n.model.value=n.model.value||r.defaultValue;Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);i.items=[];r.items.forEach(t=>{var r=Object.assign({},t);r.checked=n.model.value.indexOf(r.value)>-1;i.items.push(r)});i.showDescriptions=Object.toBoolean(r.showDescriptions);i.showIcons=Object.toBoolean(r.showIcons);i.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;i.changed=e;i.labelCheckAll="Check all";i.labelUncheckAll="Uncheck all";t.localizeMany(["contentment_checkboxListCheckAll","contentment_checkboxListUncheckAll"]).then(function(n){i.labelCheckAll=n[0];i.labelUncheckAll=n[1]});i.toggleAll=Object.toBoolean(r.checkAll);i.toggleAll&&(i.toggle=o,i.toggleChecked=i.items.every(n=>n.checked))}function e(){i.toggleChecked=i.items.every(n=>n.checked);n.model.value=[];i.items.forEach(t=>{t.checked&&n.model.value.push(t.value)});u()}function o(){n.model.value=[];i.items.forEach(t=>{t.disabled||(t.checked=i.toggleChecked,t.checked&&n.model.value.push(t.value))});u()}function u(){n.propertyForm&&n.propertyForm.$setDirty()}var r=Object.assign({},{items:[],checkAll:0,showDescriptions:0,showIcons:0,defaultValue:[]},n.model.config),i=this;f()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.CodeEditor.Controller",["$scope",function(n){function u(){i.cssClasses=n.model.labelOnTop?[]:["umb-property-editor--limit-width"];i.readonly=Object.toBoolean(t.readonly);i.options={autoFocus:!1,showGutter:Object.toBoolean(t.showGutter),useWrapMode:Object.toBoolean(t.useWrapMode),showInvisibles:Object.toBoolean(t.showInvisibles),showIndentGuides:Object.toBoolean(t.showIndentGuides),useSoftTabs:Object.toBoolean(t.useSoftTabs),showPrintMargin:Object.toBoolean(t.showPrintMargin),disableSearch:Object.toBoolean(t.disableSearch),theme:t.theme,mode:t.mode,firstLineNumber:t.firstLineNumber,advanced:{fontSize:t.fontSize,enableSnippets:Object.toBoolean(t.enableSnippets),enableBasicAutocompletion:Object.toBoolean(t.enableBasicAutocompletion),enableLiveAutocompletion:Object.toBoolean(t.enableLiveAutocompletion),minLines:t.minLines,maxLines:t.maxLines,wrap:Object.toBoolean(t.useWrapMode)}}}var r={showGutter:1,useWrapMode:1,showInvisibles:0,showIndentGuides:0,useSoftTabs:1,showPrintMargin:0,disableSearch:0,theme:"chrome",mode:"javascript",firstLineNumber:1,fontSize:"small",enableSnippets:0,enableBasicAutocompletion:0,enableLiveAutocompletion:0,readonly:0,minLines:undefined,maxLines:undefined},t=Object.assign({},r,n.model.config),i=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ConfigurationEditorInline.Controller",["$scope","formHelper",function(n){function r(){t.editor=Object.assign({},i.editor);n.model.value=n.model.value||{key:t.editor.key,value:t.editor.defaultValues||{}};n.model.value.key!==t.editor.key&&(n.model.value.key=t.editor.key);t.editor.fields&&t.editor.fields.length>0&&t.editor.fields.forEach(t=>{t.alias=t.key,n.model.value.value.hasOwnProperty(t.key)&&(t.value=n.model.value.value[t.key])});n.$on("formSubmitting",function(){t.editor.fields&&t.editor.fields.length>0&&t.editor.fields.forEach(t=>{n.model.value.value[t.key]=t.value})})}var i=Object.assign({},{editor:{}},n.model.config),t=this;r()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ConfigurationEditor.Controller",["$scope","$interpolate","$timeout","editorService","eventsService","localizationService","overlayService","Umbraco.Community.Contentment.Services.DevMode",function(n,t,i,r,u,f,e,o){function v(){n.model.value=n.model.value||[];Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);n.model.value.forEach(n=>{n.hasOwnProperty("type")&&(n.key=n.type,delete n.type)});Number.isInteger(s.maxItems)===!1&&(s.maxItems=Number.parseInt(s.maxItems)||l.maxItems);s.itemLookup={};s.allowEdit={};s.expressions={};s.missingItem={};s.items.forEach(n=>{if(s.itemLookup.hasOwnProperty(n.key)===!1&&(s.itemLookup[n.key]=n),s.allowEdit.hasOwnProperty(n.key)===!1&&(s.allowEdit[n.key]=n.fields&&n.fields.length>0),s.expressions.hasOwnProperty(n.key)===!1&&(s.expressions[n.key]={},n.nameTemplate&&(s.expressions[n.key].name=t(n.nameTemplate)),n.descriptionTemplate&&(s.expressions[n.key].description=t(n.descriptionTemplate)),n.expressions))for(let[r,i]of Object.entries(n.expressions))i&&(s.expressions[n.key][r]=t(i))});f.localizeMany(["contentment_missingItemName","contentment_missingItemDescription"]).then(n=>{s.missingItem.name=n[0],s.missingItem.description=n[1],s.missingItem.icon="icon-alert"});h.allowAdd=s.maxItems===0||n.model.value.length<s.maxItems;h.allowEdit=n=>s.allowEdit[n.key];h.allowRemove=Object.toBoolean(s.allowRemove);h.allowSort=Object.toBoolean(s.disableSorting)===!1&&s.maxItems!==1;h.displayMode=s.displayMode||"list";h.sortableOptions={axis:"y",containment:"parent",cursor:"move",disabled:h.allowSort===!1,opacity:.7,scroll:!0,tolerance:"pointer",stop:()=>{c()}};h.addButtonLabelKey=s.addButtonLabelKey||"general_add";h.add=y;h.edit=p;h.populate=w;h.remove=b;h.propertyActions=[];Object.toBoolean(s.enableDevMode)&&h.propertyActions.push({labelKey:"contentment_editRawValue",icon:"brackets",method:()=>o.editValue(n.model,k)});i(()=>a(),100)}function y(){var t=Object.toBoolean(s.allowDuplicates)?s.items:s.items.filter(t=>n.model.value.some(n=>t.key===n.key)===!1);r.open({view:s.overlayView,size:s.items.length===1?s.items[0].overlaySize:"small",config:{mode:"select",autoSelect:s.items.length===1,label:n.model.label,items:t,enableFilter:Object.toBoolean(s.enableFilter),orderBy:s.orderBy,help:s.help,cacheKey:n.model.alias},value:{},submit:function(t){n.model.value.push(t);s.maxItems!==0&&n.model.value.length>=s.maxItems&&(h.allowAdd=!1);c();r.close()},close:function(){r.close()}})}function p(t){var i=n.model.value[t],u=s.itemLookup[i.key];r.open({view:s.overlayView,size:u.overlaySize,config:{mode:"edit",editor:u,cacheKey:n.model.alias},value:i,submit:function(i){n.model.value[t]=i;c();r.close()},close:function(){r.close()}})}function a(){u.emit("contentment.config-editor.model",n.model)}function w(n,t,i){var f="",r,u;return s.itemLookup.hasOwnProperty(n.key)===!1&&s.missingItem?s.missingItem[i]||i:(s.expressions.hasOwnProperty(n.key)===!0&&(r=s.expressions[n.key],r.hasOwnProperty(i)===!0&&(u=r[i],u&&(n.value.$index=t+1,f=u(n.value),delete n.value.$index))),f||s.itemLookup[n.key][i])}function b(t){f.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(function(i){e.open({title:i[1],content:i[0],closeButtonLabel:i[2],submitButtonLabel:i[3],submitButtonStyle:"danger",submit:function(){n.model.value.splice(t,1);(s.maxItems===0||n.model.value.length<s.maxItems)&&(h.allowAdd=!0);c();e.close()},close:function(){e.close()}})})}function k(){h.allowAdd=s.maxItems!==0&&n.model.value.length>=s.maxItems?!1:!0;c()}function c(){n.propertyForm&&n.propertyForm.$setDirty();a()}var l={addButtonLabelKey:"general_add",allowDuplicates:0,allowRemove:1,disableSorting:0,displayMode:"list",enableDevMode:0,enableFilter:0,help:null,items:[],maxItems:0,orderBy:"name",overlayView:""},s=Object.assign({},l,n.model.config),h=this;v()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.Overlays.ConfigurationEditor.Controller",["$scope","formHelper",function(n){function e(){if(t.mode=i.mode,t.mode==="select")i.autoSelect&&i.items.length===1?u(i.items[0]):(t.title="Select "+i.label.toLowerCase()+"...",t.help=i.help,t.items=i.items,t.enableFilter=i.enableFilter,t.orderBy=i.orderBy,t.select=u,t.cacheKey=i.cacheKey);else if(t.mode==="edit"&&i.editor){var f=n.model.value||{key:"",value:{}};r(i.editor,f)}t.close=o}function r(i,r){i.overlaySize&&n.model.size!==i.overlaySize&&(n.model.size=i.overlaySize);r.value||(r.value={});t.title="Configure "+i.name;t.editor=Object.assign({},i);t.editor.fields&&t.editor.fields.length>0&&t.editor.fields.forEach(n=>{n.alias=n.key,n.value=r.value[n.key]});t.save=f}function u(n){Array.isArray(n.fields)&&n.fields.length>0?(t.mode="edit",r(n,{value:n.defaultValues||{}})):f(n)}function o(){n.model.close&&n.model.close()}function f(t){n.$broadcast("formSubmitting",{scope:n});var i={key:t.key,value:{}};t.fields&&t.fields.forEach(n=>{i.value[n.key]=n.value});n.model.submit&&n.model.submit(i)}var i=Object.assign({},{mode:"select",autoSelect:!0,label:"",items:[],editor:null,enableFilter:!1,orderBy:"name",help:null,cacheKey:null},n.model.config),t=this;e()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ContentBlocks.Controller",["$scope","$q","$http","$interpolate","clipboardService","contentResource","editorService","editorState","localizationService","notificationsService","overlayService","umbRequestHelper","Umbraco.Community.Contentment.Services.DevMode",function(n,t,i,r,u,f,e,o,s,h,c,l,a){function nt(){v.currentPage=n.node||o.getCurrent();v.currentPageId=v.currentPage.id>0?v.currentPage.id:v.currentPage.parentId;v.currentPageId||(v.currentPageId=-1);n.model.value=n.model.value||[];n.model.value===""&&(n.model.value=[]);Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);v.elementTypeScaffoldCache={};v.elementTypeLookup={};v.nameTemplates={};v.contentBlockTypes.forEach(n=>{v.elementTypeLookup[n.key]=n,v.nameTemplates[n.key]=r(n.nameTemplate||"Item {{ $index }}")});y.addButtonLabelKey=v.addButtonLabelKey||"grid_addElement";y.displayMode=v.displayMode;y.enablePreview=Object.toBoolean(v.enablePreview);y.allowAdd=v.maxItems===0||v.maxItems==="0"||n.model.value.length<v.maxItems;y.allowCopy=Object.toBoolean(v.allowCopy)&&u.isSupported();y.allowEdit=Object.toBoolean(v.allowEdit);y.allowRemove=Object.toBoolean(v.allowRemove);y.allowSort=Object.toBoolean(v.disableSorting)===!1&&v.maxItems!==1&&v.maxItems!=="1";y.add=tt;y.copy=p;y.edit=it;y.remove=ut;y.populateIcon=rt;y.populateName=k;y.sort=()=>b();y.previews=[];y.blockActions=[];for(var t=0;t<n.model.value.length;t++)y.blockActions.push(g(t));b();y.propertyActions=[];y.allowCopy===!0&&y.propertyActions.push({labelKey:"contentment_copyAllBlocks",icon:"documents",method:function(){for(var t=0;t<n.model.value.length;t++)p(t)}});Object.toBoolean(v.enableDevMode)===!0&&y.propertyActions.push({labelKey:"contentment_editRawValue",icon:"brackets",method:function(){a.editValue(n.model,function(){})}})}function g(n){var t=[];return y.allowCopy===!0&&t.push({labelKey:"contentment_copyContentBlock",icon:"documents",method:()=>p(n)}),Object.toBoolean(v.allowCreateContentTemplate)===!0&&t.push({labelKey:"contentment_createContentTemplate",icon:"blueprint",method:()=>ft(n)}),t}function tt(){e.open({config:{elementTypes:v.contentBlockTypes,enableFilter:v.enableFilter,currentPage:v.currentPage,currentPageId:v.currentPageId},size:v.contentBlockTypes.length===1?v.contentBlockTypes[0].overlaySize:"small",value:null,view:v.overlayView,submit:function(t){n.model.value.push(t);var i=n.model.value.length-1;y.blockActions.push(g(i));w(i);v.maxItems!==0&&v.maxItems!=="0"&&n.model.value.length>=v.maxItems&&(y.allowAdd=!1);d();e.close()},close:function(){e.close()}})}function p(i){var e=n.model.value[i],r=v.elementTypeLookup[e.elementType],o=k(e,i),s=v.elementTypeScaffoldCache.hasOwnProperty(r.alias)===!1?f.getScaffold(v.currentPageId,r.alias):t.when(v.elementTypeScaffoldCache[r.alias]);s.then(n=>{var i,s,f,t;if(v.elementTypeScaffoldCache.hasOwnProperty(r.alias)===!1&&(v.elementTypeScaffoldCache[r.alias]=n),n.name=o,n.variants[0].name=o,e.value)for(i=0;i<n.variants[0].tabs.length;i++)for(s=n.variants[0].tabs[i],f=0;f<s.properties.length;f++)t=s.properties[f],e.value.hasOwnProperty(t.alias)&&(t.propertyAlias=t.alias,t.value=e.value[t.alias]);u.copy("elementType",r.alias,n)})}function it(t){var i=n.model.value[t],r=v.elementTypeLookup[i.elementType];e.open({config:{elementType:r,currentPageId:v.currentPageId},size:r.overlaySize,value:i,view:v.overlayView,submit:function(i){n.model.value[t]=i;w(t);d();e.close()},close:function(){e.close()}})}function w(t){if(y.enablePreview===!0){var r=n.model.value[t];v.elementTypeLookup[r.elementType].previewEnabled&&(y.previews[r.key]={loading:!0},l.resourcePromise(i.post("backoffice/Contentment/ContentBlocksApi/GetPreviewMarkup",r,{params:{elementIndex:t,elementKey:r.key,contentId:v.currentPageId}}),"Failed to retrieve preview markup").then(n=>{n&&n.elementKey&&n.markup&&(y.previews[n.elementKey]={loading:!1,markup:n.markup})}))}}function b(){if(y.enablePreview===!0)for(var t=0;t<n.model.value.length;t++)w(t)}function rt(n){return n.hasOwnProperty("icon")===!0?n.icon:n.elementType?v.elementTypeLookup[n.elementType].icon:"icon-document"}function k(n,t){var i="",r=v.nameTemplates[n.elementType];return r?(n.value.$index=t+1,i=r(n.value),delete n.value.$index):i=v.elementTypeLookup[n.elementType].name,i}function ut(t){s.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(i=>{c.open({title:i[1],content:i[0],closeButtonLabel:i[2],submitButtonLabel:i[3],submitButtonStyle:"danger",submit:function(){n.model.value.splice(t,1);y.blockActions.pop();b();(v.maxItems===0||v.maxItems==="0"||n.model.value.length<v.maxItems)&&(y.allowAdd=!0);d();c.close()},close:function(){c.close()}})})}function ft(t){s.localizeMany(["blueprints_createBlueprintFrom","blueprints_blueprintDescription","blueprints_createdBlueprintHeading","blueprints_createdBlueprintMessage","general_cancel","general_create"]).then(i=>{var r=n.model.value[t],u=k(r,t),e=v.elementTypeLookup[r.elementType];c.open({disableBackdropClick:!0,title:s.tokenReplace(i[0],[u]).replace("<em>","'").replace("<\/em>","'"),description:i[1],blueprintName:u,view:"/App_Plugins/Contentment/editors/content-blocks.blueprint.html",closeButtonLabel:i[4],submitButtonLabel:i[5],submitButtonStyle:"action",submit:function(n){delete n.error;n.submitButtonState="busy";var t={save:!0,name:n.blueprintName,tabs:[{properties:Object.entries(r.value).map(n=>({id:0,alias:n[0],value:n[1]}))}]},o={action:"saveNew",id:0,parentId:-1,contentTypeAlias:e.alias,expireDate:null,releaseDate:null,templateAlias:null,variants:[Object.assign({},t,{save:!0})]};f.saveBlueprint(o,!0,[],!1).then(t=>{n.submitButtonState="success",h.success(i[2],s.tokenReplace(i[3],[u])),e.blueprints.push({id:t.id,name:t.variants[0].name}),c.close()},t=>{n.submitButtonState="error",n.error=t.data.ModelState.Name[0]})},close:function(){c.close()}})})}function d(){n.propertyForm&&n.propertyForm.$setDirty()}var v=Object.assign({},{addButtonLabelKey:"grid_addElement",allowCopy:1,allowCreateContentTemplate:0,allowEdit:1,allowRemove:1,contentBlockTypes:[],disableSorting:0,displayMode:"blocks",enableDevMode:0,enableFilter:0,enablePreview:0,maxItems:0,overlayView:""},n.model.config),y=this;nt()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.Overlays.ContentBlocks.Controller",["$scope","blueprintConfig","clipboardService","contentResource",function(n,t,i,r){function h(){u.submit=y;u.close=p;u.contentNodeModel=f.currentPage||{variants:[]};f.elementType&&n.model.value?s(f.elementType,n.model.value):(u.mode="select",u.items=f.elementTypes,u.selectedElementType=null,u.clipboardItems=typeof i.retrieveDataOfType=="function"?i.retrieveDataOfType("elementType",f.elementTypes.map(n=>n.alias)):i.retriveDataOfType("elementType",f.elementTypes.map(n=>n.alias)),f.elementTypes.length>1||u.clipboardItems.length>0?(u.title="Add content",u.description="Select a content type...",u.icon="icon-page-add",u.selectBlueprint=!1,u.enableFilter=Object.toBoolean(f.enableFilter),u.select=o,u.paste=v,u.clearClipboard=c,u.prompt=!1,u.showPrompt=l,u.hidePrompt=a):f.elementTypes.length===1&&o(f.elementTypes[0]))}function c(){u.clipboardItems=[];i.clearEntriesOfType("elementType",f.elementTypes.map(n=>n.alias))}function l(){u.prompt=!0}function a(){u.prompt=!1}function o(n){n.blueprints&&n.blueprints.length>0?n.blueprints.length===1&&t.skipSelect?e(n,n.blueprints[0]):(u.title="Add content",u.description="Select a content blueprint...",u.icon="icon-blueprint",u.selectBlueprint=!0,u.selectedElementType=n,u.blueprintAllowBlank=t.allowBlank,u.create=e):e(n)}function e(t,i){n.model.size=t.overlaySize;u.mode="edit";u.loading=!0;u.title="Edit content";u.description=t.name;u.icon=t.icon;u.content={elementType:t.key,key:String.CreateGuid()};var e=i&&i.id>0?r.getBlueprintScaffold(f.currentPageId,i.id):r.getScaffold(f.currentPageId,t.alias);e.then(n=>{Object.assign(u.content,n.variants[0]),u.loading=!1})}function v(t){var e=f.elementTypes.find(n=>n.alias===t.contentTypeAlias),o,i,h,r,u;if(n.model.size=e.overlaySize,o={elementType:e.key,key:String.CreateGuid(),value:{}},t.variants.length>0)for(i=0;i<t.variants[0].tabs.length;i++)for(h=t.variants[0].tabs[i],r=0;r<h.properties.length;r++)u=h.properties[r],typeof u.value!="function"&&(o.value[u.propertyAlias]=u.value);s(e,o)}function s(n,t){u.mode="edit";u.loading=!0;u.title="Edit content";u.description=n.name;u.icon=n.icon;u.content={elementType:n.key,key:t.key};r.getScaffold(f.currentPageId,n.alias).then(n=>{var i,e,r,f;if(t.value)for(i=0;i<n.variants[0].tabs.length;i++)for(e=n.variants[0].tabs[i],r=0;r<e.properties.length;r++)f=e.properties[r],t.value.hasOwnProperty(f.alias)&&(f.value=t.value[f.alias]);Object.assign(u.content,n.variants[0]);u.loading=!1})}function y(){var f,t,e,i,r;if(n.model.submit){if(n.$broadcast("formSubmitting",{scope:n}),f={elementType:u.content.elementType,key:u.content.key,value:{}},u.content.tabs.length>0)for(t=0;t<u.content.tabs.length;t++)for(e=u.content.tabs[t],i=0;i<e.properties.length;i++)r=e.properties[i],typeof r.value!="function"&&(f.value[r.alias]=r.value);n.model.submit(f)}}function p(){n.model.close&&n.model.close()}var f=Object.assign({},{elementType:null,elementTypes:[],enableFilter:!0,currentPage:null,currentPageId:-2},n.model.config),u=this;h()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ContentSource.Controller",["$scope","editorService","entityResource",function(n,t,i){function f(){n.model.value&&n.model.value.startsWith("umb://document/")?(r.node={},r.loading=!0,i.getById(n.model.value,"Document").then(n=>{u(n),r.loading=!1})):r.node=null;r.showHelp=!1;r.showSearch=!1;r.pick=e;r.remove=o;r.show=s;r.hide=h;r.help=c;r.clear=l}function e(){t.treePicker({idType:"udi",section:"content",treeAlias:"content",multiPicker:!1,submit:function(i){var r=i.selection[0];u(r);n.model.value=r.udi;t.close()},close:function(){t.close()}})}function o(){n.model.value=null;r.node=null}function s(){r.showSearch=!0}function h(){r.showSearch=!1}function c(){r.showHelp=!r.showHelp}function l(){r.showSearch=!1;n.model.value=null}function u(n){r.node=n;i.getUrl(n.id,"Document").then(n=>{r.node.path=n})}var a=Object.assign({},{},n.model.config),r=this;f()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DataList.Editor.Controller",["$scope","editorService","localizationService","overlayService","Umbraco.Community.Contentment.Services.DevMode",function(n,t,i,r,u){function l(){n.model.value=n.model.value||[];Number.isInteger(f.maxItems)===!1&&(f.maxItems=Number.parseInt(f.maxItems)||s.maxItems);f.confirmRemoval=Object.toBoolean(f.confirmRemoval);e.allowAdd=f.maxItems===0||n.model.value.length<f.maxItems;e.focusName=!1;e.hideDescription=Object.toBoolean(f.hideDescription);e.hideIcon=Object.toBoolean(f.hideIcon);e.sortableOptions={axis:"y",containment:"parent",cursor:"move",opacity:.7,scroll:!0,tolerance:"pointer",stop:()=>o()};e.notes=f.notes;e.add=a;e.blur=v;e.edit=h;e.open=y;e.remove=p;Object.toBoolean(f.enableDevMode)===!0&&n.umbProperty&&n.umbProperty.setPropertyActions([{labelKey:"contentment_editRawValue",icon:"brackets",method:h},{labelKey:"clipboard_labelForRemoveAllEntries",icon:"trash",method:()=>{n.model.value=[]}}])}function a(){e.focusName=e.hideIcon===!0;n.model.value.push({icon:f.defaultIcon,name:"",value:"",description:""});f.maxItems!==0&&n.model.value.length>=f.maxItems&&(e.allowAdd=!1);o()}function v(n){(n.name&&n.value==null||n.value==="")&&(n.value=n.name.toCamelCase())}function h(){u.editValue(n.model,()=>{})}function y(n){var i=n.icon.split(" ");t.iconPicker({icon:i[0],color:i[1],submit:function(i){n.icon=[i.icon,i.color].filter(n=>n).join(" ");e.focusName=!0;o();t.close()},close:function(){t.close()}})}function p(n){if(f.confirmRemoval===!0)i.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(t=>{r.open({title:t[1],content:t[0],closeButtonLabel:t[2],submitButtonLabel:t[3],submitButtonStyle:"danger",submit:function(){c(n);r.close()},close:function(){r.close()}})});else c(n)}function c(t){n.model.value.splice(t,1);(f.maxItems===0||n.model.value.length<f.maxItems)&&(e.allowAdd=!0);o()}function o(){n.propertyForm&&n.propertyForm.$setDirty()}var s={confirmRemoval:0,defaultIcon:"icon-stop",enableDevMode:0,hideDescription:!1,hideIcon:!1,maxItems:0,notes:null},f=Object.assign({},s,n.model.config),e=this;l()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DataList.Preview.Controller",["$scope","$http","eventsService","umbRequestHelper",function(n,t,i,r){function e(){u.property={};u.state="loading";u.tabs=[{label:"Editor preview",alias:"listEditor",active:!1},{label:"Data source items",alias:"dataSource",active:!1},{label:"JSON",alias:"rawJson",active:!1}];u.changeTab=n=>{u.tabs.forEach(n=>n.active=!1),u.activeTab=n.alias,n.active=!0};u.changeTab(u.tabs[0]);var t=[];t.push(i.on("contentment.config-editor.model",(n,t)=>{f[t.alias]=t.value,o()}));n.$on("$destroy",()=>{for(var n in t)i.unsubscribe(t[n])})}function o(){_.isEmpty(f.dataSource)===!1&&_.isEmpty(f.listEditor)===!1?(u.state="loading",u.property=null,r.resourcePromise(t.post("backoffice/Contentment/DataListApi/GetPreview",f),"Failed to retrieve data list preview.").then(n=>{u.property=n,u.state=n.config.items&&n.config.items.length>0?"loaded":"noItems",u.tabs[1].label="Data source items ("+n.config.items.length+")"})):u.state=_.isEmpty(f.dataSource)===!1?"dataSourceConfigured":_.isEmpty(f.listEditor)===!1?"listEditorConfigured":"init"}var f=Object.assign({alias:n.model.alias},n.model.config),u=this;e()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DataListSource.Preview.Controller",["$scope","$http","eventsService","umbRequestHelper",function(n,t,i,r){function e(){u.property={};u.state="loading";u.tabs=[{label:"Data source items",alias:"dataSource",active:!1},{label:"JSON",alias:"rawJson",active:!1}];u.changeTab=n=>{u.tabs.forEach(n=>n.active=!1),u.activeTab=n.alias,n.active=!0};u.changeTab(u.tabs[0]);var t=[];t.push(i.on("contentment.config-editor.model",(n,t)=>{f[t.alias]=t.value,o()}));n.$on("$destroy",()=>{for(var n in t)i.unsubscribe(t[n])})}function o(){_.isEmpty(f.dataSource)===!1?(u.state="loading",u.items=null,r.resourcePromise(t.post("backoffice/Contentment/DataListApi/GetDataSourceItems",f),"Failed to retrieve data source items.").then(n=>{u.items=n.config.items,u.state=u.items&&u.items.length>0?"loaded":"noItems",u.tabs[0].label="Data source items ("+u.items.length+")"})):u.state="init"}var f=Object.assign({},n.model.config),u=this;e()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DataTable.Controller",["$scope","Umbraco.Community.Contentment.Services.DevMode",function(n,t){function e(){n.model.value=n.model.value||[];Number.isInteger(r.maxItems)===!1&&(r.maxItems=Number.parseInt(r.maxItems)||f.maxItems);i.headings=r.fields.map(n=>n.label);i.items=[];n.model.value.forEach((t,u)=>{var f=[];r.fields.forEach((i,r)=>{f.push(Object.assign({alias:[n.model.alias,u,r].join("_"),value:t[i.key]},i))});i.items.push(f)});i.styleTable={"max-width":Object.toBoolean(r.restrictWidth)?"800px":"100%","background-color":"#f6f4f4"};i.styleButton=Object.toBoolean(r.restrictWidth)?{}:{"max-width":"100%"};i.usePrevalueEditors=Object.toBoolean(r.usePrevalueEditors)?!0:null;i.allowAdd=r.maxItems===0||i.items.length<r.maxItems;i.allowRemove=!0;i.sortable=Object.toBoolean(r.disableSorting)===!1&&r.maxItems!==1;i.sortableOptions={axis:"y",containment:"parent",cursor:"move",disabled:i.sortable===!1,forcePlaceholderSize:!0,handle:".handle",helper:function(n,t){return t.children().each(function(){$(this).width($(this).width())}),t.clone()},items:"> tr",opacity:.7,scroll:!0,tolerance:"pointer",stop:()=>u()};i.showPrompt=c;i.hidePrompt=l;i.add=o;i.remove=h;n.umbProperty&&n.umbProperty.setPropertyActions([{labelKey:"contentment_editRawValue",icon:"brackets",method:function(){t.editValue(n.model,()=>{})}},{labelKey:"clipboard_labelForRemoveAllEntries",icon:"trash",method:function(){s()}}])}function o(){i.items.push(angular.copy(r.fields));r.maxItems!==0&&i.items.length>=r.maxItems&&(i.allowAdd=!1);u()}function s(){i.items=[];n.model.value=[];u()}function h(n){i.items.splice(n,1);(r.maxItems===0||i.items.length<r.maxItems)&&(i.allowAdd=!0);u()}function c(n){n.prompt=!0}function l(n){delete n.prompt}function u(){n.propertyForm&&n.propertyForm.$setDirty()}var f={fields:[],disableSorting:0,maxItems:0,restrictWidth:0,usePrevalueEditors:1},r=Object.assign({},f,n.model.config),i=this,a=n.$on("formSubmitting",function(){n.model.value=[];i.items.forEach(t=>{var i={};t.forEach(n=>{i[n.key]=n.value});n.model.value.push(i)})});n.$on("$destroy",()=>a());e()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DictionaryPicker.Controller",["$scope","entityResource","editorService",function(n,t,i){function o(){n.model.value=n.model.value||[];Number.isInteger(r.maxItems)===!1&&(r.maxItems=Number.parseInt(r.maxItems)||f.maxItems);u.addButtonLabelKey=r.addButtonLabelKey||"general_add";u.defaultIcon="icon-book-alt";u.displayMode="list";u.allowAdd=r.maxItems===0||r.maxItems==="0"||n.model.value.length<r.maxItems;u.allowSort=Object.toBoolean(r.disableSorting)===!1&&r.maxItems!==1;u.add=s;u.remove=h}function s(){i.treePicker({section:"translation",treeAlias:"dictionary",entityType:"dictionary",multiPicker:!1,title:"Dictionary item",emptyStateMessage:"No dictionary items to choose from",select:function(t){n.model.value.push({id:t.id,name:t.name});r.maxItems!==0&&r.maxItems!=="0"&&n.model.value.length>=r.maxItems&&(u.allowAdd=!1);e();i.close()},close:function(){i.close()}})}function h(t){n.model.value.splice(t,1);(r.maxItems===0||n.model.value.length<r.maxItems)&&(u.allowAdd=!0);e()}function e(){n.propertyForm&&n.propertyForm.$setDirty()}var f={addButtonLabelKey:"general_add",disableSorting:0,maxItems:0},r=Object.assign({},f,n.model.config),u=this;o()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.DropdownList.Controller",["$scope",function(n){function r(){i.showEmpty=Object.toBoolean(i.allowEmpty);t.items=i.items.slice();n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)?n.model.value=n.model.value[0]:i.showEmpty===!1&&n.model.value===""&&t.items.length>0&&(n.model.value=t.items[0].value);t.showEmpty=i.showEmpty===!0&&t.items.some(t=>t.value===n.model.value);t.htmlAttributes=i.htmlAttributes;t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;t.change=u}function u(){t.showEmpty=i.showEmpty===!0&&t.items.some(t=>t.value===n.model.value)}var i=Object.assign({},{items:[],allowEmpty:1,defaultValue:"",htmlAttributes:[]},n.model.config),t=this;r()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.EditorNotes.Controller",["$scope",function(n){function r(){i.alertType=t.alertType;i.icon=t.icon;i.heading=t.heading;i.message=t.message;i.hidePropertyGroup=n.model.hasOwnProperty("contentTypeId")===!1&&Object.toBoolean(t.hidePropertyGroup)}var t=Object.assign({},{hidePropertyGroup:0},n.model.config),i=this;r()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.IconPicker.Controller",["$scope","editorService",function(n,t){function f(){n.model.value=n.model.value||r.defaultIcon;Array.isArray(r.size)===!0&&(r.size=r.size[0]);i.label=n.model.value.replace(" ","<br>");i.size=r.size;i.allowAdd=n.model.value==="";i.pick=e;i.remove=o}function e(){var f=n.model.value.split(" "),e={icon:f[0],color:f[1],hideColors:Object.toBoolean(r.hideColors),submit:function(r){n.model.value=[r.icon,r.color].filter(n=>n).join(" ");i.label=n.model.value.replace(" ","<br>");i.allowAdd=!1;u();t.close()},close:function(){t.close()}};t.iconPicker(e)}function o(){n.model.value="";i.label="";i.allowAdd=!0;u()}function u(){n.propertyForm&&n.propertyForm.$setDirty()}var r=Object.assign({},{defaultIcon:"",hideColors:0,size:"large"},n.model.config),i=this;f()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.ItemPicker.Controller",["$scope","editorService","focusService","localizationService","overlayService",function(n,t,i,r,u){function l(){if(n.model.value=n.model.value||f.defaultValue,Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]),Number.isInteger(f.maxItems)===!1&&(f.maxItems=Number.parseInt(f.maxItems)||h.maxItems),Array.isArray(f.overlaySize)===!0&&(f.overlaySize=f.overlaySize[0]),f.confirmRemoval=Object.toBoolean(f.confirmRemoval),f.enableMultiple=Object.toBoolean(f.enableMultiple)&&f.maxItems!==1,e.defaultIcon=f.defaultIcon,e.displayMode=f.displayMode||"list",e.allowAdd=f.maxItems===0||n.model.value.length<f.maxItems,e.allowEdit=!1,e.allowRemove=!0,e.allowSort=Object.toBoolean(f.disableSorting)===!1&&f.maxItems!==1,e.addButtonLabelKey=f.addButtonLabelKey||"general_add",e.add=a,e.remove=y,e.sort=()=>{n.model.value=e.items.map(n=>n.value)},e.items=[],n.model.value.length>0&&f.items.length>0){var t=[];n.model.value.forEach(n=>{var i=f.items.find(t=>t.value===n);i?e.items.push(Object.assign({},i)):t.push(n)});t.length>0&&(n.model.value=_.difference(n.model.value,t),(f.maxItems===0||n.model.value.length<f.maxItems)&&(e.allowAdd=!0))}n.umbProperty&&(e.propertyActions=[],Object.toBoolean(f.allowClear)===!0&&e.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:v}),e.propertyActions.length>0&&n.umbProperty.setPropertyActions(e.propertyActions))}function a(){i.rememberFocus();var r=Object.toBoolean(f.allowDuplicates)?f.items:f.items.filter(n=>e.items.some(t=>n.value===t.value)===!1);t.open({config:{title:"Choose...",enableFilter:Object.toBoolean(f.enableFilter),enableMultiple:f.enableMultiple,defaultIcon:f.defaultIcon,items:r,listType:f.listType,orderBy:f.overlayOrderBy,maxItems:f.maxItems===0?f.maxItems:f.maxItems-e.items.length},view:f.overlayView,size:f.overlaySize||"small",submit:function(i){i.forEach(t=>{e.items.push(angular.copy(t)),n.model.value.push(t.value)});f.maxItems!==0&&n.model.value.length>=f.maxItems&&(e.allowAdd=!1);t.close();o();s()},close:function(){t.close();s()}})}function v(){e.items=[];n.model.value=[];o()}function y(n){if(i.rememberFocus(),f.confirmRemoval===!0)r.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(t=>{u.open({title:t[1],content:t[0],closeButtonLabel:t[2],submitButtonLabel:t[3],submitButtonStyle:"danger",submit:function(){c(n);u.close()},close:function(){u.close();s()}})});else c(n)}function c(t){e.items.splice(t,1);n.model.value.splice(t,1);(f.maxItems===0||n.model.value.length<f.maxItems)&&(e.allowAdd=!0);o()}function o(){n.propertyForm&&n.propertyForm.$setDirty()}function s(){var n=i.getLastKnownFocus();n&&n.focus()}var h={addButtonLabelKey:"general_add",allowClear:0,allowDuplicates:0,confirmRemoval:0,defaultIcon:"icon-science",defaultValue:[],disableSorting:0,displayMode:"list",enableFilter:1,enableMultiple:0,items:[],maxItems:0,listType:"grid",overlayView:"",overlayOrderBy:"name",overlaySize:"small"},f=Object.assign({},h,n.model.config),e=this;l()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.Overlays.ItemPicker.Controller",["$scope",function(n){function u(){t.title=i.title;t.enableFilter=i.enableFilter;t.enableMultiple=i.enableMultiple;t.defaultIcon=i.defaultIcon;t.items=i.items;t.listType=i.listType;t.orderBy=i.orderBy;t.maxItems=i.maxItems;t.itemCount=0;t.allowSubmit=!1;t.select=f;t.submit=r;t.close=e}function f(u){u.disabled!==!0&&(t.enableMultiple===!0?(u.selected=!u.selected,t.itemCount=t.items.filter(n=>n.selected===!0).length,t.allowSubmit=t.itemCount>0&&(i.maxItems===0||t.itemCount<=i.maxItems)):(n.model.value=u,r()))}function r(){if(n.model.submit){var i=[];t.enableMultiple===!0?t.items.forEach(n=>{n.selected&&(delete n.selected,i.push(n))}):i.push(n.model.value);n.model.submit(i)}}function e(){n.model.close&&n.model.close()}var i=Object.assign({},{title:"Select...",enableFilter:!1,enableMultiple:!1,defaultIcon:"icon-science",items:[],listType:"grid",orderBy:"name",maxItems:0},n.model.config),t=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.MacroPicker.Controller",["$scope","entityResource","editorService","localizationService","overlayService",function(n,t,i,r,u){function s(){n.model.value=n.model.value||[];e.defaultIcon="icon-settings-alt";e.displayMode="list";e.allowAdd=f.maxItems===0||f.maxItems==="0"||n.model.value.length<f.maxItems;e.allowEdit=!0;e.allowRemove=!0;e.allowSort=Object.toBoolean(f.disableSorting)===!1&&f.maxItems!==1&&f.maxItems!=="1";e.addButtonLabelKey=f.addButtonLabelKey||"defaultdialogs_selectMacro";e.add=h;e.edit=c;e.remove=l;e.populateDescription=a}function h(){i.macroPicker({dialogData:{richTextEditor:!1,macroData:{macroAlias:""},allowedMacros:f.availableMacros},submit:function(t){n.model.value.push({udi:t.selectedMacro.udi,name:t.selectedMacro.name,alias:t.selectedMacro.alias,params:_.object(_.map(t.macroParams,n=>[n.alias,n.value]))});f.maxItems!==0&&f.maxItems!=="0"&&n.model.value.length>=f.maxItems&&(e.allowAdd=!1);o();i.close()},close:function(){i.close()}})}function c(t){var r=n.model.value[t];i.macroPicker({dialogData:{richTextEditor:!1,macroData:{macroAlias:r.alias,macroParamsDictionary:r.params},allowedMacros:f.availableMacros},submit:function(r){n.model.value[t]={udi:r.selectedMacro.udi,name:r.selectedMacro.name,alias:r.selectedMacro.alias,params:_.object(_.map(r.macroParams,n=>[n.alias,n.value]))};o();i.close()},close:function(){i.close()}})}function l(t){r.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(i=>{u.open({title:i[1],content:i[0],closeButtonLabel:i[2],submitButtonLabel:i[3],submitButtonStyle:"danger",submit:function(){n.model.value.splice(t,1);(f.maxItems===0||f.maxItems==="0"||n.model.value.length<f.maxItems)&&(e.allowAdd=!0);o();u.close()},close:function(){u.close()}})})}function a(n){return n.alias}function o(){n.propertyForm&&n.propertyForm.$setDirty()}var f=Object.assign({},{addButtonLabelKey:"defaultdialogs_selectMacro",availableMacros:[],disableSorting:0,maxItems:0},n.model.config),e=this;s()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.Notes.Controller",["$scope","editorState","Umbraco.Community.Contentment.Services.DevMode",function(n,t,i){function f(){Object.toBoolean(r.enableDevMode)===!0&&n.umbProperty&&n.umbProperty.setPropertyActions([{labelKey:"contentment_editRawValue",icon:"brackets",method:()=>i.editValue(n.model,e)}]);u.currentPage=n.node||t.getCurrent();u.hidePropertyGroup=n.model.hasOwnProperty("contentTypeId")===!1&&Object.toBoolean(r.hidePropertyGroup)}function e(){n.propertyForm&&n.propertyForm.$setDirty()}var r=Object.assign({},{enableDevMode:0,hidePropertyGroup:0},n.model.config),u=this;f()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.NumberInput.Controller",["$scope",function(n){function u(){n.model.value!==0&&(n.model.value=n.model.value||t.defaultValue);i.maximum=t.maximum;i.minimum=t.minimum;i.step=t.step;i.pattern=t.umbracoDataValueType==="DECIMAL"?"[-0-9]+([,.][0-9]+)?":"[-0-9]*";i.placeholderText=t.placeholderText;var u={s:"umb-property-editor-tiny",m:"umb-property-editor-small",l:"umb-property-editor--limit-width",xl:"umb-property-editor"};i.sizeClass=u[t.size]||u[r.size];i.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias}var r={placeholderText:null,defaultValue:null,maximum:null,minimum:null,size:"s",step:null,umbracoDataValueType:"INT"},t=Object.assign({},r,n.model.config),i=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.RadioButtonList.Controller",["$scope",function(n){function r(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)&&(n.model.value=n.model.value[0]);t.items=i.items.slice();t.showDescriptions=Object.toBoolean(i.showDescriptions);t.showIcons=Object.toBoolean(i.showIcons);t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;n.umbProperty&&(t.propertyActions=[],Object.toBoolean(i.allowClear)===!0&&t.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:()=>{n.model.value=i.defaultValue,setDirty()}}),t.propertyActions.length>0&&n.umbProperty.setPropertyActions(t.propertyActions))}var i=Object.assign({},{allowClear:0,items:[],showDescriptions:0,showIcons:0,defaultValue:""},n.model.config),t=this;r()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.RenderMacro.Controller",["$scope","$routeParams","macroResource",function(n,t,i){function f(){if(r.loading=!0,Array.isArray(n.model.config.macro)&&n.model.config.macro.length>0){var f=n.model.config.macro[0];Object.assign(f.params,{__propertyAlias:n.model.alias,__propertyLabel:n.model.label,__propertyCulture:n.model.culture,__propertyDataTypeKey:n.model.dataTypeKey,__propertyDescription:n.model.description,__propertyHideLabel:n.model.hideLabel});i.getMacroResultAsHtmlForEditor(f.alias,t.id,f.params).then(n=>{r.html=n,r.loading=!1},n=>{r.error={title:n.data.Message+" "+n.errorMsg,message:n.data.ExceptionMessage},r.loading=!1})}else r.error={title:"Macro not configured",message:"This data type has not been configured. Please ensure that a macro has been selected."},r.loading=!1;r.hidePropertyGroup=Object.toBoolean(u.hidePropertyGroup)}if(!n.model.hasOwnProperty("contentTypeId")){var u=Object.assign({},{hidePropertyGroup:0},n.model.config),r=this;f()}}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.SocialLinks.Controller",["$scope","editorService","localizationService","overlayService","Umbraco.Community.Contentment.Services.DevMode",function(n,t,i,r,u){function a(){n.model.value=n.model.value||[];Number.isInteger(f.maxItems)===!1&&(f.maxItems=Number.parseInt(f.maxItems)||h.maxItems);f.confirmRemoval=Object.toBoolean(f.confirmRemoval);e.allowAdd=f.maxItems===0||n.model.value.length<f.maxItems;e.focusIdx=-1;e.sortableOptions={axis:"y",containment:"parent",cursor:"move",opacity:.7,scroll:!0,tolerance:"pointer",stop:function(){o()}};f.lookup=_.indexBy(f.networks,"network");e.add=v;e.edit=c;e.getIcon=y;e.getStyle=p;e.pick=l;e.remove=w;Object.toBoolean(f.enableDevMode)===!0&&n.umbProperty&&n.umbProperty.setPropertyActions([{labelKey:"contentment_editRawValue",icon:"brackets",method:c},{labelKey:"clipboard_labelForRemoveAllEntries",icon:"trash",method:function(){n.model.value=[]}}])}function v(){e.focusIdx=-1;n.model.value.push({network:"",name:"",url:""});l(n.model.value.length-1);f.maxItems!==0&&n.model.value.length>=f.maxItems&&(e.allowAdd=!1);o()}function c(){u.editValue(n.model,function(){})}function y(n){var t=f.lookup[n];return t&&t.icon?t.icon:f.defaultIcon}function p(n){var t=f.lookup[n];return t&&t.backgroundColor&&t.iconColor?{backgroundColor:t.backgroundColor,color:t.iconColor,borderRadius:"5px",paddingTop:0}:{backgroundColor:f.defaultBackgroundColor,color:f.defaultIconColor,borderRadius:"5px",borderStyle:"dashed",paddingTop:0}}function l(t){var i=n.model.value[t];r.open({title:"Select a social network...",config:{items:f.networks},position:"center",size:"small",view:f.overlayView,value:i,hideSubmitButton:!0,submit:function(n){i.network=n.network;i.name===""&&(i.name=n.name);i.url===""&&(i.url=n.url);e.focusIdx=t;o();r.close()},close:function(){i.network===""&&s(t);r.close()}})}function w(n){if(f.confirmRemoval===!0)i.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(function(t){r.open({title:t[1],content:t[0],closeButtonLabel:t[2],submitButtonLabel:t[3],submitButtonStyle:"danger",submit:function(){s(n);r.close()},close:function(){r.close()}})});else s(n)}function s(t){n.model.value.splice(t,1);(f.maxItems===0||n.model.value.length<f.maxItems)&&(e.allowAdd=!0);o()}function o(){n.propertyForm&&n.propertyForm.$setDirty()}var h={confirmRemoval:0,defaultIcon:"icon-add",defaultBackgroundColor:"#f6f4f4",defaultIconColor:"#9e9e9e",enableDevMode:0,maxItems:0,overlayView:"",networks:[]},f=Object.assign({},h,n.model.config),e=this;a()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.Tags.Controller",["$rootScope","$scope","$element","angularHelper","assetsService","localizationService","overlayService",function(n,t,i,r,u,f,e){function v(){t.model.value=t.model.value||s.defaultValue;Array.isArray(t.model.value)===!1&&(t.model.value=[t.model.value]);s.confirmRemoval=Object.toBoolean(s.confirmRemoval);o.items=[];o.showIcons=Object.toBoolean(s.showIcons);o.uniqueId=t.model.hasOwnProperty("dataTypeKey")?["tags",t.model.alias,t.model.dataTypeKey.substring(0,8)].join("-"):["tags",t.model.alias].join("-");o.add=h;o.keyDown=p;o.keyUp=w;o.remove=l;o.loading=!0;u.loadJs("lib/typeahead.js/typeahead.bundle.min.js").then(()=>{t.model.value.forEach(n=>{var t=s.items.find(t=>t.value===n);t&&o.items.push(Object.assign({},t))});o.loading=!1;var n=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name","value"),queryTokenizer:Bloodhound.tokenizers.whitespace,initialize:!1,local:s.items.filter(n=>!n.disabled),identify:n=>n.value});n.initialize().then(()=>{var t={display:"name",minLength:0,source:(t,i)=>{t&&t.length>0?n.search(t,i):i(n.all())}};o.editor=i.find("input.typeahead").typeahead({hint:!0,highlight:!0,minLength:1},t).bind("typeahead:select",h).bind("typeahead:autocomplete",h)})});t.umbProperty&&(o.propertyActions=[],Object.toBoolean(s.allowClear)===!0&&o.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:y}),o.propertyActions.length>0&&t.umbProperty.setPropertyActions(o.propertyActions))}function h(i,u){r.safeApply(n,function(){o.items.push(Object.assign({},u));t.model.value.push(u.value);o.editor.typeahead("val","");c()})}function y(){o.items=[];t.model.value=[];c()}function p(n){var t,i;n.keyCode==13&&(t=o.editor.data("ttTypeahead"),t&&t.menu&&t.menu.isOpen()===!0&&(i=t.menu.getActiveSelectable()||t.menu.getTopSelectable(),t.menu.trigger("selectableClicked",i),n.preventDefault()))}function w(n,t){(n.keyCode===8||n.keyCode===46)&&l(t)}function l(n){if(s.confirmRemoval===!0)f.localizeMany(["contentment_removeItemMessage","general_remove","general_cancel","contentment_removeItemButton"]).then(t=>{e.open({title:t[1],content:t[0],closeButtonLabel:t[2],submitButtonLabel:t[3],submitButtonStyle:"danger",submit:function(){a(n);e.close()},close:function(){e.close()}})});else a(n)}function a(n){o.items.splice(n,1);t.model.value.splice(n,1);c()}function c(){t.propertyForm&&t.propertyForm.$setDirty()}var s=Object.assign({},{allowClear:0,confirmRemoval:0,defaultValue:[],items:[],showIcons:0},t.model.config),o=this;v()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.TemplatedList.Controller",["$scope",function(n){function u(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)===!1&&(n.model.value=[n.model.value]);t.multiple=Object.toBoolean(i.enableMultiple);t.multiple===!1&&n.model.value.length>0&&n.model.value.splice(1);t.items=[];i.items.forEach(i=>{var r=Object.assign({},i);r.selected=n.model.value.indexOf(r.value)>-1;t.items.push(r)});t.htmlAttributes=i.htmlAttributes;t.template=i.template;t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;t.select=e;n.umbProperty&&(t.propertyActions=[],Object.toBoolean(i.allowClear)===!0&&t.propertyActions.push({labelKey:"buttons_clearSelection",icon:"trash",method:f}),t.propertyActions.length>0&&n.umbProperty.setPropertyActions(t.propertyActions))}function f(){n.model.value=[];t.items.forEach(n=>n.selected=!1);r()}function e(i){i.selected=i.selected===!1;n.model.value=[];t.items.forEach(r=>{t.multiple===!1&&(r.selected=r.value===i.value),r.selected&&n.model.value.push(r.value)});r()}function r(){n.propertyForm&&n.propertyForm.$setDirty()}var i=Object.assign({},{allowClear:0,defaultValue:[],enableMultiple:0,items:[],template:"{{ item.name }}",htmlAttributes:[]},n.model.config),t=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.TextboxList.Controller",["$scope","Umbraco.Community.Contentment.Services.DevMode",function(n,t){function u(){n.model.value=n.model.value||{};Utilities.isObject(n.model.value)===!1&&(n.model.value={});i.keys=[];i.icons={};i.names={};i.inputTypes=["color","email","number","password","tel","text","url"];i.hideIcon=r.labelStyle==="text";i.hideName=r.labelStyle==="icon";i.defaultIcon=r.defaultIcon;r.items.forEach(t=>{i.keys.push(t.value),i.names[t.value]=t.name,i.hideIcon===!1&&(i.icons[t.value]=(t.icon||r.defaultIcon)+" medium"),n.model.value.hasOwnProperty(t.value)===!1&&(n.model.value[t.value]="")});Object.keys(n.model.value).forEach(t=>{i.keys.indexOf(t)===-1&&delete n.model.value[t]});i.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;n.umbProperty&&(i.propertyActions=[],Object.toBoolean(r.enableDevMode)===!0&&i.propertyActions.push({labelKey:"contentment_editRawValue",icon:"brackets",method:()=>t.editValue(n.model,function(){})}),i.propertyActions.length>0&&n.umbProperty.setPropertyActions(i.propertyActions))}var r=Object.assign({},{defaultIcon:"icon-science",items:[],labelStyle:"both",enableDevMode:0},n.model.config),i=this;u()}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.DataEditors.TextInput.Controller",["$scope",function(n){function r(){n.model.value=n.model.value||i.defaultValue;Array.isArray(n.model.value)&&(n.model.value=n.model.value.join(", "));t.inputType=i.inputType;t.autoComplete=Object.toBoolean(i.autocomplete)?"on":"off";t.spellCheck=Object.toBoolean(i.spellcheck)?"true":"false";t.placeholderText=i.placeholderText;t.maxChars=parseInt(0+i.maxChars);t.maxCharsThreshold=t.maxChars*.8;t.prepend=i.prepend;t.append=i.append;t.uniqueId=n.model.hasOwnProperty("dataTypeKey")?[n.model.alias,n.model.dataTypeKey.substring(0,8)].join("-"):n.model.alias;i.items&&i.items.length>0&&(t.dataList=i.items,t.dataListId="dl-"+t.uniqueId)}var i=Object.assign({},{items:[],inputType:"text",autocomplete:0,placeholderText:null,defaultValue:null,prepend:null,append:null,maxChars:500},n.model.config),t=this;r()}]),function(){"use strict";function n(n){return{bindings:{addButtonLabel:"@?",addButtonLabelKey:"<?",allowAdd:"<?",allowEdit:"<?",allowRemove:"<?",allowSort:"<?",blockActions:"<?",defaultIcon:"<?",displayMode:"<?",getItem:"<?",getItemIcon:"<?",getItemName:"<?",getItemDescription:"<?",ngModel:"=",onAdd:"<?",onEdit:"<?",onRemove:"<?",onSort:"<?",propertyActions:"<?",previews:"<?"},controllerAs:"vm",controller:["$scope","localizationService",function(t,i){function f(){typeof r.onAdd=="function"&&r.onAdd()}function e(n,t){switch(typeof r.allowEdit){case"boolean":return r.allowEdit;case"function":return r.allowEdit(n,t);default:return!0}}function o(n,t){switch(typeof r.allowRemove){case"boolean":return r.allowRemove;case"function":return r.allowRemove(n,t);default:return!0}}function s(n){if(typeof r.onEdit=="function")r.onEdit(n)}function u(n,t,i){if(typeof r.getItem=="function")return r.getItem(n,t,i);switch(i){case"icon":return typeof r.getItemIcon=="function"?r.getItemIcon(n,t):n.icon||r.defaultIcon;case"name":return typeof r.getItemName=="function"?r.getItemName(n,t):n.name;case"description":return typeof r.getItemDescription=="function"?r.getItemDescription(n,t):n.description;default:return n.hasOwnProperty(i)===!0?n[i]:undefined}}function h(n,t,i){var r=u(n,t,i);return r?angular.fromJson(r):{}}function c(n){if(typeof r.onRemove=="function")r.onRemove(n)}var r=this;r.$onInit=function(){var t=n||r.displayMode||"list";r.templateUrl="/App_Plugins/Contentment/components/"+t+"-editor.html";r.propertyAlias=r.umbProperty.property.alias;r.sortableOptions={axis:"y",containment:"parent",cursor:"move",disabled:r.allowSort===!1,opacity:.7,scroll:!0,tolerance:"pointer",stop:function(){r.onSort&&r.onSort();r.propertyForm&&r.propertyForm.$setDirty()}};t==="blocks"?Object.assign(r.sortableOptions,{cancel:"input,textarea,select,option",classes:".blockelement--dragging",cursor:"grabbing",distance:5,handle:".blockelement__draggable-element"}):t==="cards"&&Object.assign(r.sortableOptions,{axis:!1,"ui-floating":!0,items:".umb-block-card",cursor:"grabbing",placeholder:"umb-block-card --sortable-placeholder"});r.add=f;r.canEdit=e;r.canRemove=o;r.edit=s;r.populate=u;r.populateStyle=h;r.remove=c;r.isSingle=r.allowAdd===!1&&r.ngModel.length===1?"":undefined;r.addButtonLabelKey&&i.localize(r.addButtonLabelKey).then(function(n){r.addButtonLabel=n});r.propertyActions&&r.propertyActions.length>0&&r.umbProperty.setPropertyActions(r.propertyActions);r.blockActions&&r.blockActions.length>0&&r.blockActions.forEach(function(n){n.forEach(function(n){i.localize(n.labelKey).then(function(t){n.label=t})})})}}],require:{propertyForm:"^form",umbProperty:"^"},template:"<ng-include src='vm.templateUrl'><\/ng-include>"}}angular.module("umbraco.directives").component("contentmentItemsEditor",n());angular.module("umbraco.directives").component("contentmentListEditor",n("list"));angular.module("umbraco.directives").component("contentmentStackEditor",n("stack"));angular.module("umbraco.directives").component("contentmentBlocksEditor",n("blocks"));angular.module("umbraco.directives").component("contentmentCardsEditor",n("cards"))}();angular.module("umbraco.services").factory("Umbraco.Community.Contentment.Services.DevMode",["$timeout","editorService",function(n,t){return{editValue:function(i,r){t.open({title:"Edit raw value",value:Utilities.toJson(i.value,!0),ace:{showGutter:!0,useWrapMode:!0,useSoftTabs:!0,theme:"chrome",mode:"javascript",advanced:{fontSize:"14px",wrap:!0},onLoad:function(t){n(()=>t.focus())}},view:"/App_Plugins/Contentment/editors/_json-editor.html",size:"medium",submit:function(n){i.value=Utilities.fromJson(n);r&&r();t.close()},close:function(){t.close()}})}}}]);angular.module("umbraco.directives").component("leeWasHere",{template:'<img ng-src="/App_Plugins/Contentment/backoffice/contentment/lee-was-here.svg" alt="Lee was here" width="115" height="55">'});angular.module("umbraco.directives.html").directive("lkHtmlAttributes",[function(){return{restrict:"A",scope:{attributes:"&lkHtmlAttributes"},link:function(n,t){var i=n.attributes();Array.isArray(i)&&i.length>0&&i.forEach(n=>{n.name==="class"?t.addClass(n.value):t.attr(n.name,n.value)})}}}]);angular.module("umbraco.directives.html").directive("lkBindHtmlTemplate",["$compile",function(n){return{restrict:"A",replace:!0,link:function(t,i,r){t.$watch(function(n){return n.$eval(r.lkBindHtmlTemplate)},function(r){if(r){var u=n(r)(t);i.append(u)}})}}}]);angular.module("umbraco.directives.html").directive("lkHidePropertyGroup",[function(){return{restrict:"A",link:function(n,t,i){var u,f,r;if(i.lkHidePropertyGroup==="true"){if(u=t.closest(".umb-property-editor"),f=u.parent().closest(".umb-property-editor").length>0,f)return;r=t.closest(".umb-group-panel,.umb-box");r&&r.addClass("umb-group-panel--hide")}}}}]);angular.module("umbraco.filters").filter("lkNodeName",["$filter",function(n){return function(t){return Array.isArray(t)===!1?n("ncNodeName")(t):t.map(t=>n("ncNodeName")(t)).join(", ")}}]);angular.module("umbraco.filters").filter("lkGroupBy",[function(){return _.memoize((n,t)=>_.chain(n).sortBy(t).groupBy(t).value(),(n,t,i)=>[i,t,n.length].join("_"))}]);angular.module("umbraco").controller("Umbraco.Community.Contentment.Tree.Controller",["$scope","navigationService",function(n,t){function r(){const u="contentment";var r=Umbraco.Sys.ServerVariables.umbracoPlugins[u];i.title=r.name;i.version="v"+r.version;t.syncTree({tree:u,path:"-1"});n.$emit("$changeTitle",i.title);i.links=[{icon:"icon-fa fa-fw fa-book ",name:"Documentation",description:"How to use each of the property editors.",url:"https://github.com/leekelleher/umbraco-contentment/tree/master/docs"},{icon:"icon-fa fa-youtube",name:"Video demonstrations",description:"Demos, guides and tutorials on YouTube.",url:"https://www.youtube.com/playlist?list=PL8grlRt7-8oVULPYJpqido5QItRsJBt3M"},{icon:"icon-fa fa-fw fa-comments-o",name:"Support forum",description:"Ask for help, the community is your friend.",url:"https://our.umbraco.com/packages/backoffice-extensions/contentment/contentment-feedback/"},{icon:"icon-fa fa-fw fa-code-fork",name:"Source code",description:"See the code, all free and open-source.",url:"https://github.com/leekelleher/umbraco-contentment"},{icon:"icon-fa fa-fw fa-bug",name:"Issue tracker",description:"Found a bug? Suggest a feature? Let me know.",url:"https://github.com/leekelleher/umbraco-contentment/issues/new/choose"},{icon:"icon-fa fa-fw fa-id-card-o",name:"License",description:"Licensed under the Mozilla Public License.",url:"https://opensource.org/licenses/MPL-2.0"}];i.telemetryEnabled=r.telemetry===!0}var i=this;r()}])